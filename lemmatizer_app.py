import streamlit as st #–∏–º–ø–æ—Ä—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π...
from pymorphy3 import MorphAnalyzer #...–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –¥–ª—è –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏–∏...
import re #...–∏ –º–æ–¥—É–ª—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏

st.title("üìù –õ–µ–º–º–∞—Ç–∏–∑–∞—Ç–æ—Ä —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞") #—Ç—É—Ç –ø–∏—à–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫

try: #–∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
    morph = MorphAnalyzer()
except Exception as e: #–µ—Å–ª–∏ –≤ —Ö–æ–¥–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞...
    st.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {str(e)}") #...–≤—ã—Å–≤–µ—Ç–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ...
    st.stop() #...–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è

def is_russian(text): #–ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–ø–∏—Å–∞–Ω –ª–∏ —Ç–µ–∫—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Ç–µ–∫—Å—Ç —Ç–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã"""
    russian_letters = re.compile(r'^[–∞-—è–ê-–Ø—ë–Å\s\d\.,!?;:-') #—Å–∞–º —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤: —Ä—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã, –ø—Ä–æ–±–µ–ª—ã, —á–∏—Å–ª–∞, –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è
    return bool(russian_letters.fullmatch(text))

text = st.text_area("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç (–Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ!):", #—Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–∫–Ω–æ –∏ –ø–∏—à–µ—Ç—Å—è —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –Ω–∞–¥ –Ω–∏–º –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è
                   "–ì–∞—Ä—Ä–∏ –Ω–∏–∫–æ–≥–¥–∞ –µ—â–µ —Ç–∞–∫ –Ω–µ –Ω–∞–∫–∞–∑—ã–≤–∞–ª–∏, –∫–∞–∫ –∑–∞ –∏—Å—Ç–æ—Ä–∏—é —Å –±—Ä–∞–∑–∏–ª—å—Å–∫–∏–º —É–¥–∞–≤–æ–º") #–ø—Ä–∏–º–µ—Ä —Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã—Å–≤–µ—á–∏–≤–∞—Ç—å—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –æ–∫–Ω–µ

if st.button("–õ–µ–º–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å"): #—Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è, –∑–∞–¥–∞–µ—Ç—Å—è –µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
    if not is_russian(text): #–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏/–∏–ª–∏ —Å–∏–º–≤–æ–ª—ã
        st.error("–û–ë–ù–ê–†–£–ñ–ï–ù–ê –õ–ê–¢–ò–ù–ò–¶–ê –ò–õ–ò –°–ü–ï–¶.–°–ò–ú–í–û–õ–´. –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ü–†–ï–ö–†–ê–¢–ò–¢–¨.") #—Å–æ–æ–±—â–µ–Ω–∏–µ –≤—ã—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
        st.stop()  #–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
    
    words = text.split() #–µ—Å–ª–∏ —Ç–µ–∫—Å—Ç –ø—Ä–æ—à–µ–ª –ø—Ä–æ–≤–µ—Ä–∫—É, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏–¥–µ—Ç –¥–∞–ª—å—à–µ
    lemmas = [] #–∏ —Ä–∞–∑–±–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞
    
    for word in re.findall(r'[–∞-—è–ê-–Ø—ë–Å]+', text):
        try:
            parsed = morph.parse(word)
            if parsed:
                lemmas.append(parsed[0].normal_form)
        except:
            lemmas.append(word)  # –¢–µ–ø–µ—Ä—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –æ—Ç—Å—Ç—É–ø–æ–º
    
# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    st.subheader("–†–µ–∑—É–ª—å—Ç–∞—Ç:")
    st.code(" ".join(lemmas), language='text')
    
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    success_msg = f"""
    ‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(lemmas)} —Å–ª–æ–≤
    üìä –ò—Å—Ö–æ–¥–Ω—ã—Ö —Å–ª–æ–≤: {len(text.split())}
    üî¢ –ß–∏—Å–ª–æ –∑–∞–º–µ–Ω: {len(text.split()) - len(lemmas)}
    """
    st.success(success_msg)
